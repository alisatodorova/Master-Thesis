Using DataParallel on GPUs: [0, 1]
GPU 0: NVIDIA GeForce RTX 4060 Ti with 8187.5 MB memory
GPU 1: NVIDIA GeForce RTX 4060 Ti with 8187.38 MB memory
Using device: cuda
DATASET SUMMARY
Number of classes        : 47
Class labels             : ['addisplay', 'addisplay++adware', 'adload', 'adsware', 'adware', 'adware++adware', 'adware++grayware++virus', 'adware++virus', 'adwareare', 'backdoor', 'banker++trojan', 'benign', 'click', 'clicker', 'clicker++trojan', 'clickfraud++riskware', 'downloader', 'dropper++trojan', 'exploit', 'fakeangry', 'fakeapp', 'fakeapp++trojan', 'fakeinst++trojan', 'gray', 'hacktool', 'malware', 'malware++trj', 'monitor', 'ransom++trojan', 'risktool++riskware++virus', 'riskware', 'riskware++smssend', 'rog', 'rootnik++trojan', 'smssend', 'smssend++trojan', 'spr', 'spy', 'spy++trojan', 'spyware', 'trj', 'troj', 'trojan', 'trojandownloader', 'trojandropper', 'virus', 'worm']
Train samples            : 883416
Validation samples       : 126202
Test samples             : 252406
Train class distribution : {0: 12221, 1: 206, 2: 233, 3: 1856, 4: 619118, 5: 1752, 6: 585, 7: 192, 8: 106, 9: 421, 10: 774, 11: 55383, 12: 79, 13: 186, 14: 2007, 15: 258, 16: 3498, 17: 414, 18: 3907, 19: 148, 20: 298, 21: 179, 22: 503, 23: 645, 24: 379, 25: 1754, 26: 426, 27: 950, 28: 807, 29: 106, 30: 22236, 31: 173, 32: 1382, 33: 156, 34: 2286, 35: 3006, 36: 9675, 37: 1152, 38: 83, 39: 4613, 40: 658, 41: 2316, 42: 125478, 43: 398, 44: 125, 45: 134, 46: 154}
--------------------------------------------------
Using 2 GPUs.
MODEL SUMMARY
----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1         [-1, 64, 128, 128]           9,408
            Conv2d-2         [-1, 64, 128, 128]           9,408
       BatchNorm2d-3         [-1, 64, 128, 128]             128
       BatchNorm2d-4         [-1, 64, 128, 128]             128
              ReLU-5         [-1, 64, 128, 128]               0
              ReLU-6         [-1, 64, 128, 128]               0
         MaxPool2d-7           [-1, 64, 64, 64]               0
         MaxPool2d-8           [-1, 64, 64, 64]               0
            Conv2d-9           [-1, 64, 64, 64]          36,864
           Conv2d-10           [-1, 64, 64, 64]          36,864
      BatchNorm2d-11           [-1, 64, 64, 64]             128
      BatchNorm2d-12           [-1, 64, 64, 64]             128
             ReLU-13           [-1, 64, 64, 64]               0
             ReLU-14           [-1, 64, 64, 64]               0
           Conv2d-15           [-1, 64, 64, 64]          36,864
           Conv2d-16           [-1, 64, 64, 64]          36,864
      BatchNorm2d-17           [-1, 64, 64, 64]             128
      BatchNorm2d-18           [-1, 64, 64, 64]             128
             ReLU-19           [-1, 64, 64, 64]               0
       BasicBlock-20           [-1, 64, 64, 64]               0
             ReLU-21           [-1, 64, 64, 64]               0
       BasicBlock-22           [-1, 64, 64, 64]               0
           Conv2d-23           [-1, 64, 64, 64]          36,864
      BatchNorm2d-24           [-1, 64, 64, 64]             128
           Conv2d-25           [-1, 64, 64, 64]          36,864
             ReLU-26           [-1, 64, 64, 64]               0
      BatchNorm2d-27           [-1, 64, 64, 64]             128
             ReLU-28           [-1, 64, 64, 64]               0
           Conv2d-29           [-1, 64, 64, 64]          36,864
           Conv2d-30           [-1, 64, 64, 64]          36,864
      BatchNorm2d-31           [-1, 64, 64, 64]             128
             ReLU-32           [-1, 64, 64, 64]               0
       BasicBlock-33           [-1, 64, 64, 64]               0
      BatchNorm2d-34           [-1, 64, 64, 64]             128
             ReLU-35           [-1, 64, 64, 64]               0
       BasicBlock-36           [-1, 64, 64, 64]               0
           Conv2d-37          [-1, 128, 32, 32]          73,728
           Conv2d-38          [-1, 128, 32, 32]          73,728
      BatchNorm2d-39          [-1, 128, 32, 32]             256
      BatchNorm2d-40          [-1, 128, 32, 32]             256
             ReLU-41          [-1, 128, 32, 32]               0
             ReLU-42          [-1, 128, 32, 32]               0
           Conv2d-43          [-1, 128, 32, 32]         147,456
           Conv2d-44          [-1, 128, 32, 32]         147,456
      BatchNorm2d-45          [-1, 128, 32, 32]             256
      BatchNorm2d-46          [-1, 128, 32, 32]             256
           Conv2d-47          [-1, 128, 32, 32]           8,192
           Conv2d-48          [-1, 128, 32, 32]           8,192
      BatchNorm2d-49          [-1, 128, 32, 32]             256
             ReLU-50          [-1, 128, 32, 32]               0
       BasicBlock-51          [-1, 128, 32, 32]               0
      BatchNorm2d-52          [-1, 128, 32, 32]             256
           Conv2d-53          [-1, 128, 32, 32]         147,456
             ReLU-54          [-1, 128, 32, 32]               0
       BasicBlock-55          [-1, 128, 32, 32]               0
           Conv2d-56          [-1, 128, 32, 32]         147,456
      BatchNorm2d-57          [-1, 128, 32, 32]             256
      BatchNorm2d-58          [-1, 128, 32, 32]             256
             ReLU-59          [-1, 128, 32, 32]               0
             ReLU-60          [-1, 128, 32, 32]               0
           Conv2d-61          [-1, 128, 32, 32]         147,456
           Conv2d-62          [-1, 128, 32, 32]         147,456
      BatchNorm2d-63          [-1, 128, 32, 32]             256
      BatchNorm2d-64          [-1, 128, 32, 32]             256
             ReLU-65          [-1, 128, 32, 32]               0
       BasicBlock-66          [-1, 128, 32, 32]               0
             ReLU-67          [-1, 128, 32, 32]               0
       BasicBlock-68          [-1, 128, 32, 32]               0
           Conv2d-69          [-1, 256, 16, 16]         294,912
           Conv2d-70          [-1, 256, 16, 16]         294,912
      BatchNorm2d-71          [-1, 256, 16, 16]             512
      BatchNorm2d-72          [-1, 256, 16, 16]             512
             ReLU-73          [-1, 256, 16, 16]               0
             ReLU-74          [-1, 256, 16, 16]               0
           Conv2d-75          [-1, 256, 16, 16]         589,824
           Conv2d-76          [-1, 256, 16, 16]         589,824
      BatchNorm2d-77          [-1, 256, 16, 16]             512
      BatchNorm2d-78          [-1, 256, 16, 16]             512
           Conv2d-79          [-1, 256, 16, 16]          32,768
           Conv2d-80          [-1, 256, 16, 16]          32,768
      BatchNorm2d-81          [-1, 256, 16, 16]             512
      BatchNorm2d-82          [-1, 256, 16, 16]             512
             ReLU-83          [-1, 256, 16, 16]               0
             ReLU-84          [-1, 256, 16, 16]               0
       BasicBlock-85          [-1, 256, 16, 16]               0
       BasicBlock-86          [-1, 256, 16, 16]               0
           Conv2d-87          [-1, 256, 16, 16]         589,824
           Conv2d-88          [-1, 256, 16, 16]         589,824
      BatchNorm2d-89          [-1, 256, 16, 16]             512
             ReLU-90          [-1, 256, 16, 16]               0
      BatchNorm2d-91          [-1, 256, 16, 16]             512
           Conv2d-92          [-1, 256, 16, 16]         589,824
             ReLU-93          [-1, 256, 16, 16]               0
      BatchNorm2d-94          [-1, 256, 16, 16]             512
             ReLU-95          [-1, 256, 16, 16]               0
       BasicBlock-96          [-1, 256, 16, 16]               0
           Conv2d-97          [-1, 256, 16, 16]         589,824
      BatchNorm2d-98          [-1, 256, 16, 16]             512
             ReLU-99          [-1, 256, 16, 16]               0
      BasicBlock-100          [-1, 256, 16, 16]               0
          Conv2d-101            [-1, 512, 8, 8]       1,179,648
     BatchNorm2d-102            [-1, 512, 8, 8]           1,024
          Conv2d-103            [-1, 512, 8, 8]       1,179,648
            ReLU-104            [-1, 512, 8, 8]               0
     BatchNorm2d-105            [-1, 512, 8, 8]           1,024
            ReLU-106            [-1, 512, 8, 8]               0
          Conv2d-107            [-1, 512, 8, 8]       2,359,296
          Conv2d-108            [-1, 512, 8, 8]       2,359,296
     BatchNorm2d-109            [-1, 512, 8, 8]           1,024
     BatchNorm2d-110            [-1, 512, 8, 8]           1,024
          Conv2d-111            [-1, 512, 8, 8]         131,072
          Conv2d-112            [-1, 512, 8, 8]         131,072
     BatchNorm2d-113            [-1, 512, 8, 8]           1,024
     BatchNorm2d-114            [-1, 512, 8, 8]           1,024
            ReLU-115            [-1, 512, 8, 8]               0
            ReLU-116            [-1, 512, 8, 8]               0
      BasicBlock-117            [-1, 512, 8, 8]               0
      BasicBlock-118            [-1, 512, 8, 8]               0
          Conv2d-119            [-1, 512, 8, 8]       2,359,296
          Conv2d-120            [-1, 512, 8, 8]       2,359,296
     BatchNorm2d-121            [-1, 512, 8, 8]           1,024
     BatchNorm2d-122            [-1, 512, 8, 8]           1,024
            ReLU-123            [-1, 512, 8, 8]               0
            ReLU-124            [-1, 512, 8, 8]               0
          Conv2d-125            [-1, 512, 8, 8]       2,359,296
          Conv2d-126            [-1, 512, 8, 8]       2,359,296
     BatchNorm2d-127            [-1, 512, 8, 8]           1,024
     BatchNorm2d-128            [-1, 512, 8, 8]           1,024
            ReLU-129            [-1, 512, 8, 8]               0
      BasicBlock-130            [-1, 512, 8, 8]               0
            ReLU-131            [-1, 512, 8, 8]               0
      BasicBlock-132            [-1, 512, 8, 8]               0
AdaptiveAvgPool2d-133            [-1, 512, 1, 1]               0
AdaptiveAvgPool2d-134            [-1, 512, 1, 1]               0
          Linear-135                   [-1, 47]          24,111
          Linear-136                   [-1, 47]          24,111
          ResNet-137                   [-1, 47]               0
          ResNet-138                   [-1, 47]               0
================================================================
Total params: 22,401,246
Trainable params: 22,401,246
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.75
Forward/backward pass size (MB): 164.01
Params size (MB): 85.45
Estimated Total Size (MB): 250.21
----------------------------------------------------------------
Loaded epoch 50

Epoch 051 | Time: 3949.9s | Loss: 2242.9048
Train Acc: 0.8868 | Train Balanced Acc: 0.7453
Val   Acc: 0.8271 | Val   Balanced Acc: 0.5075

Epoch 052 | Time: 3960.3s | Loss: 2191.2801
Train Acc: 0.8895 | Train Balanced Acc: 0.7515
Val   Acc: 0.8235 | Val   Balanced Acc: 0.5185

Epoch 053 | Time: 3985.7s | Loss: 2145.7224
Train Acc: 0.8915 | Train Balanced Acc: 0.7537
Val   Acc: 0.8224 | Val   Balanced Acc: 0.5153

Epoch 054 | Time: 4033.1s | Loss: 2098.6216
Train Acc: 0.8935 | Train Balanced Acc: 0.7599
Val   Acc: 0.8220 | Val   Balanced Acc: 0.5074

Epoch 055 | Time: 3988.8s | Loss: 2055.8779
Train Acc: 0.8957 | Train Balanced Acc: 0.7660
Val   Acc: 0.8262 | Val   Balanced Acc: 0.5228

Epoch 056 | Time: 3956.6s | Loss: 2012.1259
Train Acc: 0.8979 | Train Balanced Acc: 0.7701
Val   Acc: 0.8281 | Val   Balanced Acc: 0.5001

Epoch 057 | Time: 4001.6s | Loss: 1973.0363
Train Acc: 0.8997 | Train Balanced Acc: 0.7750
Val   Acc: 0.8249 | Val   Balanced Acc: 0.4980

Epoch 058 | Time: 4029.0s | Loss: 1937.6381
Train Acc: 0.9015 | Train Balanced Acc: 0.7787
Val   Acc: 0.8276 | Val   Balanced Acc: 0.5120

Epoch 059 | Time: 4025.7s | Loss: 1901.2898
Train Acc: 0.9035 | Train Balanced Acc: 0.7828
Val   Acc: 0.8211 | Val   Balanced Acc: 0.5172

Epoch 060 | Time: 4060.6s | Loss: 1865.9921
Train Acc: 0.9048 | Train Balanced Acc: 0.7873
Val   Acc: 0.8230 | Val   Balanced Acc: 0.5187
Checkpoint saved at: C:\Users\Boss\Downloads\malnet-images\checkpoints\epoch_060.pt

Epoch 061 | Time: 4037.2s | Loss: 1959.3108
Train Acc: 0.9003 | Train Balanced Acc: 0.7696
Val   Acc: 0.8204 | Val   Balanced Acc: 0.5067
Epoch 062 | Time: 4030.7s | Loss: 1919.9825
Train Acc: 0.9021 | Train Balanced Acc: 0.7743
Val   Acc: 0.8245 | Val   Balanced Acc: 0.5178

Epoch 063 | Time: 4017.4s | Loss: 1882.6194
Train Acc: 0.9040 | Train Balanced Acc: 0.7804
Val   Acc: 0.8267 | Val   Balanced Acc: 0.5225
Epoch 064 | Time: 3956.9s | Loss: 1843.6783
Train Acc: 0.9058 | Train Balanced Acc: 0.7875
Val   Acc: 0.8268 | Val   Balanced Acc: 0.5249

Epoch 065 | Time: 3959.4s | Loss: 1818.4222
Train Acc: 0.9068 | Train Balanced Acc: 0.7861
Val   Acc: 0.8211 | Val   Balanced Acc: 0.5213

Epoch 066 | Time: 3967.8s | Loss: 1780.3575
Train Acc: 0.9090 | Train Balanced Acc: 0.7927
Val   Acc: 0.8283 | Val   Balanced Acc: 0.5224

Epoch 067 | Time: 3966.1s | Loss: 1750.9303
Train Acc: 0.9104 | Train Balanced Acc: 0.7923
Val   Acc: 0.8310 | Val   Balanced Acc: 0.5219

Epoch 068 | Time: 3949.6s | Loss: 1717.4538
Train Acc: 0.9122 | Train Balanced Acc: 0.7977
Val   Acc: 0.8318 | Val   Balanced Acc: 0.5027

Epoch 069 | Time: 3974.7s | Loss: 1687.6320
Train Acc: 0.9137 | Train Balanced Acc: 0.8017
Val   Acc: 0.8247 | Val   Balanced Acc: 0.5254

Epoch 070 | Time: 3959.0s | Loss: 1662.1856
Train Acc: 0.9149 | Train Balanced Acc: 0.8078
Val   Acc: 0.8326 | Val   Balanced Acc: 0.5160
Checkpoint saved at: C:\Users\Boss\Downloads\malnet-images\checkpoints\epoch_070.pt

Epoch 071 | Time: 3949.9s | Loss: 1633.1880
Train Acc: 0.9165 | Train Balanced Acc: 0.8078
Val   Acc: 0.8237 | Val   Balanced Acc: 0.5273

Epoch 072 | Time: 3975.3s | Loss: 1604.6739
Train Acc: 0.9177 | Train Balanced Acc: 0.8114
Val   Acc: 0.8320 | Val   Balanced Acc: 0.5195
    
Epoch 073 | Time: 4042.4s | Loss: 1581.3790
Train Acc: 0.9188 | Train Balanced Acc: 0.8146
Val   Acc: 0.8298 | Val   Balanced Acc: 0.5345

Epoch 074 | Time: 4058.4s | Loss: 1553.5344
Train Acc: 0.9204 | Train Balanced Acc: 0.8183
Val   Acc: 0.8291 | Val   Balanced Acc: 0.5187

Epoch 075 | Time: 4010.6s | Loss: 1531.2523
Train Acc: 0.9214 | Train Balanced Acc: 0.8192
Val   Acc: 0.8305 | Val   Balanced Acc: 0.5143

Epoch 076 | Time: 4042.5s | Loss: 1505.0374
Train Acc: 0.9226 | Train Balanced Acc: 0.8237
Val   Acc: 0.8254 | Val   Balanced Acc: 0.5287

Epoch 077 | Time: 4050.3s | Loss: 1484.4121
Train Acc: 0.9239 | Train Balanced Acc: 0.8249
Val   Acc: 0.8273 | Val   Balanced Acc: 0.5207

Epoch 078 | Time: 4053.5s | Loss: 1458.4725
Train Acc: 0.9251 | Train Balanced Acc: 0.8270
Val   Acc: 0.8326 | Val   Balanced Acc: 0.5204

Epoch 079 | Time: 4049.1s | Loss: 1436.7526
Train Acc: 0.9261 | Train Balanced Acc: 0.8280
Val   Acc: 0.8323 | Val   Balanced Acc: 0.5183

Epoch 080 | Time: 4038.4s | Loss: 1415.8822
Train Acc: 0.9270 | Train Balanced Acc: 0.8328
Val   Acc: 0.8320 | Val   Balanced Acc: 0.5220
Checkpoint saved at: C:\Users\Boss\Downloads\malnet-images\checkpoints\epoch_080.pt

Epoch 081 | Time: 4056.5s | Loss: 1391.3544
Train Acc: 0.9284 | Train Balanced Acc: 0.8378
Val   Acc: 0.8317 | Val   Balanced Acc: 0.5172

Epoch 082 | Time: 4043.6s | Loss: 1367.1632
Train Acc: 0.9295 | Train Balanced Acc: 0.8381
Val   Acc: 0.8273 | Val   Balanced Acc: 0.5107

Epoch 083 | Time: 4050.5s | Loss: 1352.6133
Train Acc: 0.9301 | Train Balanced Acc: 0.8380
Val   Acc: 0.8290 | Val   Balanced Acc: 0.5177

Epoch 084 | Time: 4025.4s | Loss: 1328.7466
Train Acc: 0.9315 | Train Balanced Acc: 0.8409
Val   Acc: 0.8303 | Val   Balanced Acc: 0.5226

Epoch 085 | Time: 4049.1s | Loss: 1311.5925
Train Acc: 0.9323 | Train Balanced Acc: 0.8422
Val   Acc: 0.8329 | Val   Balanced Acc: 0.5139

Epoch 086 | Time: 4063.8s | Loss: 1290.2205
Train Acc: 0.9333 | Train Balanced Acc: 0.8456
Val   Acc: 0.8287 | Val   Balanced Acc: 0.5290

Epoch 087 | Time: 37596.9s | Loss: 1273.6211
Train Acc: 0.9341 | Train Balanced Acc: 0.8486
Val   Acc: 0.8333 | Val   Balanced Acc: 0.5093

Epoch 088 | Time: 4179.6s | Loss: 1255.9212
Train Acc: 0.9351 | Train Balanced Acc: 0.8503
Val   Acc: 0.8335 | Val   Balanced Acc: 0.5184

Epoch 089 | Time: 4379.8s | Loss: 1237.2614
Train Acc: 0.9359 | Train Balanced Acc: 0.8520
Val   Acc: 0.8309 | Val   Balanced Acc: 0.5153

Epoch 090 | Time: 4211.4s | Loss: 1223.9508
Train Acc: 0.9366 | Train Balanced Acc: 0.8526
Val   Acc: 0.8338 | Val   Balanced Acc: 0.5231
Checkpoint saved at: C:\Users\Boss\Downloads\malnet-images\checkpoints\epoch_090.pt

Epoch 091 | Time: 4213.0s | Loss: 1224.3896
Train Acc: 0.9367 | Train Balanced Acc: 0.8543
Val   Acc: 0.8315 | Val   Balanced Acc: 0.5173

Epoch 092 | Time: 4215.8s | Loss: 1209.6711
Train Acc: 0.9372 | Train Balanced Acc: 0.8531
Val   Acc: 0.8307 | Val   Balanced Acc: 0.5207

Epoch 093 | Time: 4201.1s | Loss: 1191.5461
Train Acc: 0.9381 | Train Balanced Acc: 0.8556
Val   Acc: 0.8324 | Val   Balanced Acc: 0.5291

Epoch 094 | Time: 4171.7s | Loss: 1178.9129
Train Acc: 0.9388 | Train Balanced Acc: 0.8571
Val   Acc: 0.8335 | Val   Balanced Acc: 0.5225

Epoch 095 | Time: 3928.8s | Loss: 1162.0588
Train Acc: 0.9396 | Train Balanced Acc: 0.8590
Val   Acc: 0.8316 | Val   Balanced Acc: 0.5214

Epoch 096 | Time: 3904.6s | Loss: 1148.2222
Train Acc: 0.9403 | Train Balanced Acc: 0.8616
Val   Acc: 0.8336 | Val   Balanced Acc: 0.5196

Epoch 097 | Time: 4014.7s | Loss: 1131.9889
Train Acc: 0.9411 | Train Balanced Acc: 0.8616
Val   Acc: 0.8335 | Val   Balanced Acc: 0.5251

Epoch 098 | Time: 4023.3s | Loss: 1120.6479
Train Acc: 0.9416 | Train Balanced Acc: 0.8634
Val   Acc: 0.8323 | Val   Balanced Acc: 0.5249

Epoch 099 | Time: 4037.2s | Loss: 1106.0809
Train Acc: 0.9421 | Train Balanced Acc: 0.8662
Val   Acc: 0.8327 | Val   Balanced Acc: 0.5270

Epoch 100 | Time: 4058.0s | Loss: 1094.9681
Train Acc: 0.9429 | Train Balanced Acc: 0.8672
Val   Acc: 0.8334 | Val   Balanced Acc: 0.5211
Checkpoint saved at: C:\Users\Boss\Downloads\malnet-images\checkpoints\epoch_100.pt
Model Accuracy: 83.28%
